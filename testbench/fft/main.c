void application(void);
void test(void);

#define SAMPLES 7

extern short result[1 << SAMPLES];

int sine_init[1<<SAMPLES] =
{
32768,35979,39160,42279,45307,48214,50972,53555,
55938,58097,60013,61666,63041,64124,64905,65377,
65535,65377,64905,64124,63041,61666,60013,58097,
55938,53555,50972,48214,45307,42279,39160,35979,
32768,29556,26375,23256,20228,17321,14563,11980,
9597,7438,5522,3869,2494,1411,630,158,
0,158,630,1411,2494,3869,5522,7438,
9597,11980,14563,17321,20228,23256,26375,29556,
32768,35979,39160,42279,45307,48214,50972,53555,
55938,58097,60013,61666,63041,64124,64905,65377,
65535,65377,64905,64124,63041,61666,60013,58097,
55938,53555,50972,48214,45307,42279,39160,35979,
32768,29556,26375,23256,20228,17321,14563,11980,
9597,7438,5522,3869,2494,1411,630,158,
0,158,630,1411,2494,3869,5522,7438,
9597,11980,14563,17321,20228,23256,26375,29556,
32768,35979,39160,42279,45307,48214,50972,53555,
55938,58097,60013,61666,63041,64124,64905,65377,
65535,65377,64905,64124,63041,61666,60013,58097,
55938,53555,50972,48214,45307,42279,39160,35979,
32768,29556,26375,23256,20228,17321,14563,11980,
9597,7438,5522,3869,2494,1411,630,158,
0,158,630,1411,2494,3869,5522,7438,
9597,11980,14563,17321,20228,23256,26375,29556,
32768,35979,39160,42279,45307,48214,50972,53555,
55938,58097,60013,61666,63041,64124,64905,65377,
65535,65377,64905,64124,63041,61666,60013,58097,
55938,53555,50972,48214,45307,42279,39160,35979,
32768,29556,26375,23256,20228,17321,14563,11980,
9597,7438,5522,3869,2494,1411,630,158,
0,158,630,1411,2494,3869,5522,7438,
9597,11980,14563,17321,20228,23256,26375,29556,
};

int main()
{
  /* Set up sin wave samples. */
  for (int i = 0; i < (1<<SAMPLES); i++)
  {
      result[i] = (short)(sine_init[i] - 32768);
  }

  application();

  // Make sure that the application and test are split up.
  // The linker might place the test_failed (or equally test_passed)
  // function right after application, and we don't want to get a
  // false positive when MicroBlaze fetches the first instruction while
  // in the process of returning.
  asm("nop");
  asm("nop");
  asm("nop");
  asm("nop");

  test();
}
